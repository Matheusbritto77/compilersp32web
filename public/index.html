<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ESP32 Web IDE - Ambiente Completo de Desenvolvimento</title>
    <meta name="description" content="IDE completa para ESP32: compile, flash, monitor, configure - tudo no navegador!">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <!-- ESP Web Tools para flash -->
    <script type="module" src="https://unpkg.com/esp-web-tools@10/dist/web/install-button.js?module"></script>
    <!-- Monaco Editor para code editor -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.45.0/min/vs/loader.min.js"></script>
</head>

<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <svg viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2L2 7L12 12L22 7L12 2Z" />
                        <path d="M2 17L12 22L22 17" />
                        <path d="M2 12L12 17L22 12" />
                    </svg>
                    <span>ESP32 IDE</span>
                </div>
                <button class="btn-icon" id="toggleSidebar">‚ò∞</button>
            </div>

            <!-- Project Section -->
            <div class="sidebar-section">
                <h3>üìÅ Projeto</h3>
                <div class="project-info" id="projectInfo" style="display: none;">
                    <div class="project-name" id="currentProjectName">-</div>
                    <div class="project-target" id="currentTarget">Target: -</div>
                </div>
                <div class="upload-mini" id="uploadMini">
                    <input type="file" id="fileInput" accept=".zip" hidden>
                    <button class="btn btn-primary btn-block" id="uploadBtn">
                        üì§ Upload Projeto (.zip)
                    </button>
                </div>
            </div>

            <!-- Files Section -->
            <div class="sidebar-section" id="filesSection" style="display: none;">
                <h3>üìÑ Arquivos</h3>
                <div class="file-tree" id="fileTree"></div>
            </div>

            <!-- Actions Section -->
            <div class="sidebar-section">
                <h3>‚ö° A√ß√µes</h3>
                <div class="action-buttons">
                    <button class="btn btn-action" id="btnSetTarget" disabled>
                        üéØ Set Target
                    </button>
                    <button class="btn btn-action btn-success" id="btnBuild" disabled>
                        ‚ñ∂Ô∏è Build
                    </button>
                    <button class="btn btn-action" id="btnClean" disabled>
                        üßπ Clean
                    </button>
                    <button class="btn btn-action" id="btnFlash" disabled>
                        ‚ö° Flash
                    </button>
                    <button class="btn btn-action" id="btnMonitor" disabled>
                        üìü Monitor
                    </button>
                </div>
            </div>

            <!-- Analysis Section -->
            <div class="sidebar-section">
                <h3>üìä An√°lise</h3>
                <div class="action-buttons">
                    <button class="btn btn-action" id="btnSize" disabled>
                        üìè Size
                    </button>
                    <button class="btn btn-action" id="btnSizeComponents" disabled>
                        üì¶ Size Components
                    </button>
                    <button class="btn btn-action" id="btnSizeFiles" disabled>
                        üìÑ Size Files
                    </button>
                </div>
            </div>

            <!-- Configuration Section -->
            <div class="sidebar-section">
                <h3>‚öôÔ∏è Configura√ß√£o</h3>
                <div class="action-buttons">
                    <button class="btn btn-action" id="btnMenuconfig" disabled>
                        üîß sdkconfig
                    </button>
                    <button class="btn btn-action" id="btnPartitions" disabled>
                        üíæ Partitions
                    </button>
                    <button class="btn btn-action" id="btnReconfigure" disabled>
                        üîÑ Reconfigure
                    </button>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Toolbar -->
            <div class="toolbar">
                <div class="toolbar-left">
                    <select id="targetSelect" class="select-input">
                        <option value="esp32">ESP32</option>
                        <option value="esp32s2">ESP32-S2</option>
                        <option value="esp32s3">ESP32-S3</option>
                        <option value="esp32c3">ESP32-C3 (RISC-V)</option>
                        <option value="esp32c6">ESP32-C6</option>
                        <option value="esp32h2">ESP32-H2</option>
                    </select>
                    <button class="btn btn-primary" id="btnQuickBuild" disabled>
                        ‚ñ∂Ô∏è Build
                    </button>
                    <esp-web-install-button id="espInstallButton" style="display: none;">
                        <button slot="activate" class="btn btn-success">‚ö° Flash</button>
                    </esp-web-install-button>
                </div>
                <div class="toolbar-right">
                    <div class="status-indicator" id="statusIndicator">
                        <span class="dot"></span>
                        <span class="text">Pronto</span>
                    </div>
                </div>
            </div>

            <!-- Tabs -->
            <div class="tabs" id="tabs">
                <button class="tab active" data-tab="terminal">üìü Terminal</button>
                <button class="tab" data-tab="editor">üìù Editor</button>
                <button class="tab" data-tab="config">‚öôÔ∏è Config</button>
                <button class="tab" data-tab="partitions">üíæ Parti√ß√µes</button>
                <button class="tab" data-tab="flash">‚ö° Flash</button>
                <button class="tab" data-tab="monitor">üìü Monitor Serial</button>
            </div>

            <!-- Tab Contents -->
            <div class="tab-contents">
                <!-- Terminal Tab -->
                <div class="tab-content active" id="tab-terminal">
                    <div class="terminal">
                        <div class="terminal-header">
                            <div class="terminal-dots">
                                <span></span><span></span><span></span>
                            </div>
                            <span class="terminal-title">Build Output</span>
                            <button class="btn-icon" id="clearTerminal" title="Limpar">üóëÔ∏è</button>
                        </div>
                        <div class="terminal-body" id="terminalBody">
                            <pre id="terminalOutput">ESP32 Web IDE - Aguardando projeto...

Funcionalidades dispon√≠veis:
‚Ä¢ Build / Compila√ß√£o
‚Ä¢ Flash via Web Serial
‚Ä¢ Monitor Serial
‚Ä¢ Editor de C√≥digo
‚Ä¢ Configura√ß√£o (sdkconfig)
‚Ä¢ Editor de Parti√ß√µes
‚Ä¢ An√°lise de Tamanho

Para come√ßar, fa√ßa upload de um projeto ESP-IDF (.zip)
</pre>
                        </div>
                    </div>
                </div>

                <!-- Editor Tab -->
                <div class="tab-content" id="tab-editor">
                    <div class="editor-container">
                        <div class="editor-tabs" id="editorTabs">
                            <span class="no-file">Nenhum arquivo aberto</span>
                        </div>
                        <div id="monacoEditor" class="monaco-editor-container"></div>
                    </div>
                </div>

                <!-- Config Tab -->
                <div class="tab-content" id="tab-config">
                    <div class="config-container">
                        <div class="config-header">
                            <h2>‚öôÔ∏è SDK Configuration (sdkconfig)</h2>
                            <div class="config-actions">
                                <input type="text" id="configSearch" placeholder="Buscar configura√ß√£o..."
                                    class="input-search">
                                <button class="btn btn-primary" id="saveConfig">üíæ Salvar</button>
                            </div>
                        </div>
                        <div class="config-list" id="configList">
                            <p class="placeholder">Carregue um projeto para ver as configura√ß√µes</p>
                        </div>
                    </div>
                </div>

                <!-- Partitions Tab -->
                <div class="tab-content" id="tab-partitions">
                    <div class="partitions-container">
                        <div class="partitions-header">
                            <h2>üíæ Tabela de Parti√ß√µes</h2>
                            <div class="partitions-actions">
                                <button class="btn btn-outline" id="addPartition">‚ûï Adicionar</button>
                                <button class="btn btn-primary" id="savePartitions">üíæ Salvar</button>
                            </div>
                        </div>
                        <div class="partitions-visual" id="partitionsVisual"></div>
                        <table class="partitions-table" id="partitionsTable">
                            <thead>
                                <tr>
                                    <th>Nome</th>
                                    <th>Tipo</th>
                                    <th>SubTipo</th>
                                    <th>Offset</th>
                                    <th>Tamanho</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody id="partitionsBody">
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Flash Tab -->
                <div class="tab-content" id="tab-flash">
                    <div class="flash-container">
                        <div class="flash-header">
                            <h2>‚ö° Flash Manager</h2>
                        </div>
                        <div class="flash-content">
                            <div class="flash-section">
                                <h3>üì¶ Bin√°rios Dispon√≠veis</h3>
                                <div class="binaries-grid" id="binariesGrid">
                                    <p class="placeholder">Fa√ßa build do projeto primeiro</p>
                                </div>
                            </div>
                            <div class="flash-section">
                                <h3>üîå Conex√£o</h3>
                                <div class="connection-status" id="connectionStatus">
                                    <span class="dot offline"></span>
                                    <span>Desconectado</span>
                                </div>
                                <div class="flash-options">
                                    <label>
                                        <input type="checkbox" id="eraseFlash">
                                        Apagar flash antes de gravar
                                    </label>
                                    <label>
                                        <input type="checkbox" id="verifyFlash" checked>
                                        Verificar ap√≥s gravar
                                    </label>
                                </div>
                                <esp-web-install-button id="mainFlashButton">
                                    <button slot="activate" class="btn btn-success btn-large">
                                        ‚ö° Gravar no ESP32
                                    </button>
                                </esp-web-install-button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Monitor Tab -->
                <div class="tab-content" id="tab-monitor">
                    <div class="monitor-container">
                        <div class="monitor-header">
                            <h2>üìü Monitor Serial</h2>
                            <div class="monitor-controls">
                                <select id="baudRate" class="select-input">
                                    <option value="9600">9600 bps</option>
                                    <option value="115200" selected>115200 bps</option>
                                    <option value="230400">230400 bps</option>
                                    <option value="460800">460800 bps</option>
                                    <option value="921600">921600 bps</option>
                                    <option value="2000000">2000000 bps</option>
                                </select>
                                <button class="btn btn-primary" id="connectSerial">üîå Conectar</button>
                                <button class="btn btn-outline" id="clearMonitor">üóëÔ∏è Limpar</button>
                                <button class="btn btn-outline" id="downloadLogs">üì• Download</button>
                                <label class="toggle">
                                    <input type="checkbox" id="autoScroll" checked>
                                    Auto-scroll
                                </label>
                                <label class="toggle">
                                    <input type="checkbox" id="showTimestamp">
                                    Timestamp
                                </label>
                            </div>
                        </div>
                        <div class="terminal monitor-terminal">
                            <div class="terminal-body" id="monitorBody">
                                <pre id="monitorOutput">Clique em "Conectar" para iniciar o monitor serial...</pre>
                            </div>
                        </div>
                        <div class="monitor-input">
                            <input type="text" id="serialInput" placeholder="Digite comando e pressione Enter..."
                                disabled>
                            <button class="btn btn-primary" id="sendSerial" disabled>Enviar</button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modals -->
    <div class="modal" id="targetModal" style="display: none;">
        <div class="modal-content">
            <h2>üéØ Selecionar Target</h2>
            <p>Escolha o chip ESP32 de destino:</p>
            <div class="target-grid">
                <button class="target-option" data-target="esp32">
                    <span class="chip-icon">üì¶</span>
                    <span class="chip-name">ESP32</span>
                    <span class="chip-desc">Xtensa LX6 Dual-core</span>
                </button>
                <button class="target-option" data-target="esp32s2">
                    <span class="chip-icon">üì¶</span>
                    <span class="chip-name">ESP32-S2</span>
                    <span class="chip-desc">Xtensa LX7 Single-core</span>
                </button>
                <button class="target-option" data-target="esp32s3">
                    <span class="chip-icon">üì¶</span>
                    <span class="chip-name">ESP32-S3</span>
                    <span class="chip-desc">Xtensa LX7 Dual-core + AI</span>
                </button>
                <button class="target-option" data-target="esp32c3">
                    <span class="chip-icon">üì¶</span>
                    <span class="chip-name">ESP32-C3</span>
                    <span class="chip-desc">RISC-V Single-core</span>
                </button>
                <button class="target-option" data-target="esp32c6">
                    <span class="chip-icon">üì¶</span>
                    <span class="chip-name">ESP32-C6</span>
                    <span class="chip-desc">RISC-V + WiFi 6</span>
                </button>
                <button class="target-option" data-target="esp32h2">
                    <span class="chip-icon">üì¶</span>
                    <span class="chip-name">ESP32-H2</span>
                    <span class="chip-desc">RISC-V + Thread/Zigbee</span>
                </button>
            </div>
            <button class="btn btn-outline" id="closeTargetModal">Cancelar</button>
        </div>
    </div>

    <script src="app.js"></script>
</body>

</html>